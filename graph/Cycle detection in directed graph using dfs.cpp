// Detect cycle in directed graph
#include <bits/stdc++.h>
using namespace std;

 // } Driver Code Ends
class Solution {
  public:
    bool solve(int i, vector<int> &vis, vector<int> &order, vector<int> adj[]){
        vis[i] = 1;
        order[i] = 1;
        for(auto it: adj[i]){
            if(!vis[it]){
                if(solve(it, vis, order, adj))
                return true;
            }else if(order[it]) return true;
        }
        order[i] = 0;
         return false;
    }
    bool isCyclic(int V, vector<int> adj[]) {
        vector<int> vis(V, 0);
        vector<int> order(V, 0);
        for(int i = 0 ; i < V; i++){
            if(!vis[i])
            if(solve(i, vis, order, adj)) return true;
        }
        return false;
    }
};

// { Driver Code Starts.

int main() {

    int t;
    cin >> t;
    while (t--) {
        int V, E;
        cin >> V >> E;

        vector<int> adj[V];

        for (int i = 0; i < E; i++) {
            int u, v;
            cin >> u >> v;
            adj[u].push_back(v);
        }

        Solution obj;
        cout << obj.isCyclic(V, adj) << "\n";
    }

    return 0;
}
  /*
  1
  91 1474
88 75
75 65
65 67
67 48
48 14
14 38
38 7
7 11
11 22
22 56
56 52
52 49
49 84
84 0
0 71
71 3
3 8
8 33
33 44
44 54
54 16
16 30
30 72
72 87
87 29
29 21
21 1
1 42
42 90
90 46
46 83
83 55
55 47
47 26
26 19
19 57
57 76
76 89
89 78
78 64
64 73
73 63
63 34
34 66
66 50
50 43
43 62
62 13
13 25
25 79
79 6
6 53
53 69
69 20
20 45
45 58
58 81
81 31
31 51
51 18
18 77
77 4
4 17
17 27
27 15
15 5
5 39
39 37
37 24
24 74
74 82
82 23
23 59
59 36
36 80
80 60
60 10
10 61
61 85
85 70
70 28
28 41
41 35
35 9
9 12
12 68
68 32
32 86
86 2
2 40
78 34
22 65
34 61
42 8
67 45
52 47
82 41
11 46
82 75
71 85
38 39
7 42
24 81
8 12
67 30
18 33
83 30
0 39
27 57
69 3
23 5
51 89
65 47
70 24
65 83
20 3
89 22
33 30
62 89
4 42
45 64
1 8
39 61
90 14
62 11
19 55
25 47
33 75
81 19
63 75
13 21
48 72
20 80
78 49
84 9
87 79
85 80
83 31
13 33
75 52
10 2
10 82
66 62
16 88
71 24
8 2
57 19
53 29
51 61
48 83
10 9
11 1
68 74
78 77
70 59
65 54
85 22
57 27
72 70
49 66
44 25
13 80
82 78
77 34
33 14
8 64
32 54
89 27
66 31
81 13
25 75
38 37
30 61
83 12
46 31
84 90
0 60
83 27
51 72
50 45
28 18
20 7
19 35
26 46
37 54
47 40
76 32
45 73
81 47
82 80
51 60
30 6
32 64
62 81
65 4
84 56
36 63
85 34
6 1
42 0
60 82
87 4
5 41
25 65
18 52
61 59
83 72
81 1
75 79
19 50
10 32
78 7
87 74
84 78
34 10
84 85
18 48
86 14
61 11
85 90
14 76
55 63
70 2
14 18
53 37
67 64
27 63
71 86
18 84
41 65
10 76
29 38
48 7
52 58
80 62
79 40
40 8
21 11
27 77
22 34
78 53
45 29
51 64
83 9
16 62
55 46
83 75
49 36
77 52
19 42
35 21
71 4
76 15
51 86
87 73
47 9
33 83
71 51
37 71
4 34
73 20
86 40
46 49
81 71
65 84
36 38
4 23
32 75
31 28
27 46
62 55
61 60
48 31
29 43
10 27
90 87
80 76
3 57
88 33
22 6
59 48
37 88
86 18
77 3
34 63
20 13
54 32
65 87
0 83
66 72
84 61
0 23
27 82
76 26
45 59
68 53
42 44
90 41
37 51
16 36
49 12
52 0
24 50
22 51
8 51
53 8
31 6
47 63
13 61
9 74
36 52
70 10
47 44
34 54
62 84
17 79
8 37
60 52
29 57
11 73
32 33
67 87
69 67
31 72
27 0
51 21
31 62
5 72
38 52
45 56
6 49
39 72
62 20
53 70
37 75
25 48
87 38
66 85
72 9
17 12
10 58
89 54
14 90
79 8
42 79
12 60
55 27
54 87
45 10
34 49
38 64
76 22
16 74
33 89
11 51
37 2
14 31
30 73
36 49
28 46
88 57
16 29
13 68
39 4
45 62
37 32
25 34
11 55
45 35
87 31
33 84
58 60
19 38
64 83
89 86
50 68
74 90
75 19
85 4
47 56
80 42
17 62
39 71
23 70
7 28
22 33
24 57
67 84
61 88
19 67
89 28
81 39
2 48
84 76
90 11
58 71
17 78
63 10
63 78
11 70
31 37
46 29
55 16
35 61
26 75
56 44
2 70
41 28
56 61
43 30
20 37
10 12
68 30
88 62
46 53
73 45
70 86
5 69
8 60
56 14
74 6
36 58
1 9
0 42
81 36
83 49
86 22
75 27
31 32
64 21
55 61
29 44
47 74
27 75
76 0
45 82
4 69
76 77
6 13
29 1
7 64
78 54
56 40
40 35
79 30
88 45
78 38
37 45
15 36
26 10
25 11
73 19
25 17
31 44
78 80
40 26
27 16
6 17
58 88
40 67
73 46
50 1
55 29
21 5
90 85
54 10
1 72
8 4
80 39
17 13
55 33
69 15
37 87
55 38
75 35
27 12
32 36
82 86
70 73
25 19
56 32
54 50
76 72
74 19
29 28
54 62
61 45
85 83
66 59
57 52
29 19
51 78
20 70
44 29
17 83
8 40
67 9
64 5
56 37
61 33
83 20
77 64
45 22
74 71
4 14
72 83
15 1
64 57
70 42
59 76
26 20
38 36
88 39
9 84
23 76
78 41
41 20
81 24
43 84
26 11
15 52
74 51
70 4
88 86
16 4
83 6
54 90
77 28
20 49
56 36
52 45
34 88
69 49
68 76
51 41
73 52
60 57
20 66
9 36
65 51
77 29
33 24
3 83
14 2
69 80
47 61
39 43
18 87
81 45
65 26
70 11
37 23
12 47
63 52
82 9
17 89
82 81
42 9
18 29
19 80
44 18
35 65
73 80
23 83
70 84
82 13
20 35
43 5
84 81
56 86
82 14
88 4
54 78
47 49
72 15
54 7
70 88
26 55
2 74
1 11
38 42
64 11
8 9
40 76
1 52
57 16
56 20
74 28
12 6
73 26
44 57
8 61
59 21
56 24
12 74
48 45
2 68
47 66
18 55
19 7
73 1
72 1
50 63
21 13
39 9
17 84
82 55
8 90
32 9
89 9
88 58
74 56
31 20
45 77
90 31
64 74
43 22
80 27
51 0
90 66
50 74
64 78
40 39
7 68
27 14
61 30
87 59
77 71
67 21
46 55
85 19
70 83
60 76
22 18
31 47
8 71
49 50
53 1
9 56
57 84
48 80
78 22
48 12
35 45
59 22
30 71
10 51
87 84
26 22
16 47
10 41
23 78
25 27
85 26
25 28
47 29
21 67
4 89
26 84
14 37
74 2
73 27
49 81
9 79
26 79
77 57
79 81
62 82
69 63
89 47
39 60
60 8
59 61
61 78
83 48
84 18
81 7
2 46
21 23
66 52
66 51
48 24
10 67
74 66
55 42
90 34
27 9
24 90
10 39
4 83
89 37
30 12
81 28
87 72
31 9
86 23
48 53
52 30
21 7
47 0
0 31
24 28
32 88
22 67
72 30
65 34
74 86
21 31
63 1
38 26
50 16
89 20
31 83
16 17
47 50
27 21
17 38
66 58
18 13
42 12
63 42
33 59
4 9
18 31
19 23
52 69
60 3
35 60
15 6
23 43
4 90
31 26
30 7
38 83
84 38
0 59
7 29
46 81
62 53
70 29
86 60
56 35
13 22
13 89
88 21
78 15
51 23
41 77
58 64
77 45
89 64
60 32
2 34
75 4
78 70
29 6
79 25
3 28
66 41
40 43
13 40
31 52
12 67
23 69
74 23
33 1
63 37
88 50
63 85
19 81
67 32
82 10
41 74
82 37
65 6
87 39
68 38
5 47
71 72
40 89
40 23
8 57
53 48
57 46
90 16
46 56
64 89
72 77
3 59
33 31
2 51
41 76
30 20
58 90
69 51
77 15
48 79
16 12
7 81
28 14
7 4
19 31
0 13
90 48
71 16
56 62
13 19
59 41
45 79
27 19
43 41
50 8
34 53
46 44
0 75
56 12
48 21
36 35
75 72
88 67
43 7
68 43
46 88
47 36
69 62
47 15
81 23
12 81
15 21
17 61
16 56
66 48
6 66
63 36
15 75
0 77
33 86
80 3
53 36
49 37
14 70
62 42
7 26
38 41
70 33
17 67
27 45
0 12
78 66
44 48
73 81
27 17
47 19
50 22
56 10
78 6
68 71
32 61
7 77
62 31
13 2
67 2
15 33
30 59
10 86
0 21
71 15
88 53
22 55
81 21
54 70
77 17
35 4
44 7
90 40
76 87
69 9
7 85
65 25
11 28
21 35
45 76
15 10
31 21
9 26
85 50
12 40
70 43
31 27
41 59
69 84
80 40
85 0
19 28
28 72
5 51
9 35
12 61
77 68
22 38
41 58
77 62
13 72
84 12
89 25
79 51
85 32
14 6
38 43
33 45
86 52
40 42
78 79
49 22
38 55
84 67
32 69
30 40
74 68
15 85
59 5
2 73
49 1
62 24
60 5
33 77
51 69
72 38
16 90
77 49
86 79
61 8
63 83
24 47
47 52
27 81
21 70
62 33
87 3
41 62
56 49
25 61
55 34
53 18
10 25
0 48
76 56
55 1
77 50
64 66
28 63
72 74
39 55
22 88
31 48
81 85
17 24
90 81
38 53
64 61
60 27
15 7
77 19
60 45
63 51
77 51
0 14
15 35
26 29
20 0
66 90
62 63
15 16
54 88
50 41
71 17
74 31
60 20
25 8
15 66
40 59
72 36
9 60
16 7
64 42
61 69
59 66
7 53
17 51
57 90
59 69
28 4
40 83
87 53
81 46
55 11
23 75
35 85
58 46
29 34
64 63
41 16
10 5
56 89
59 29
2 85
20 42
82 45
69 70
14 69
16 73
74 7
13 27
20 33
59 16
60 31
37 19
10 43
18 59
21 84
36 17
88 31
75 49
66 10
20 8
57 44
44 28
43 34
76 88
3 56
43 35
68 41
16 13
34 62
63 0
6 62
17 21
48 3
64 52
39 47
67 41
16 3
4 11
90 76
57 12
71 70
30 64
44 63
72 89
42 84
13 62
86 1
74 39
55 40
29 87
80 61
53 24
26 62
7 79
28 88
22 74
68 61
38 29
32 14
51 38
60 26
23 13
88 38
72 3
39 10
70 63
24 60
26 52
1 3
5 15
61 50
1 85
21 47
17 65
52 61
81 20
74 76
41 46
84 1
23 66
15 79
77 42
38 27
11 33
58 16
34 1
75 78
73 75
14 89
38 70
64 44
39 23
52 5
75 22
67 5
72 81
58 24
50 53
46 59
57 41
73 58
41 6
54 85
61 51
22 89
64 29
47 75
82 76
39 38
72 86
48 65
42 54
38 68
68 83
84 14
83 16
2 57
35 18
88 80
89 15
31 50
20 73
17 9
60 6
62 39
26 16
37 67
24 2
66 8
57 45
71 1
54 48
18 82
50 85
8 24
21 62
64 1
81 26
69 59
73 2
39 81
45 87
27 37
30 65
90 45
37 65
45 42
32 16
33 8
2 25
17 39
14 88
84 33
4 72
17 28
31 53
68 35
76 24
66 78
78 30
76 8
14 80
28 74
65 64
70 51
4 86
13 20
60 51
19 82
47 67
57 11
3 22
32 34
84 55
15 40
78 71
87 20
40 81
31 2
6 50
61 77
85 76
21 29
21 78
52 39
88 43
10 53
62 64
56 33
17 30
33 58
16 83
84 20
88 30
87 33
67 13
30 37
39 64
40 66
1 10
75 87
49 16
65 30
58 77
84 4
12 35
16 63
71 30
35 29
31 39
71 38
52 82
83 53
45 43
13 76
17 80
63 55
42 76
13 86
72 54
40 36
32 11
74 3
66 26
76 25
82 67
31 42
45 55
51 62
50 78
88 74
2 52
15 9
45 5
1 84
73 70
59 0
49 74
42 34
19 64
9 42
5 14
83 28
5 9
77 24
18 5
78 90
14 87
77 20
50 21
11 64
35 43
13 8
37 73
48 88
8 82
4 40
74 48
32 87
54 0
86 58
26 63
2 49
26 89
2 13
12 23
52 15
32 42
54 74
80 20
7 3
45 46
88 11
24 79
36 18
56 55
85 69
64 65
51 90
53 84
71 68
15 61
32 4
56 59
76 11
18 64
65 24
9 72
72 27
51 75
17 44
33 74
18 30
53 6
15 13
38 88
85 72
44 35
1 78
62 36
17 75
15 60
49 39
63 71
57 59
37 82
49 28
30 27
6 56
12 17
21 53
17 72
23 1
9 15
80 70
53 26
71 12
44 31
61 53
9 49
70 67
58 45
76 73
68 34
26 30
30 46
34 24
13 59
53 75
36 59
90 43
40 78
55 44
63 79
3 42
36 66
49 21
84 6
41 23
40 54
63 11
61 39
34 86
57 85
7 33
23 20
66 19
62 74
0 2
85 24
24 29
57 7
69 10
63 66
4 0
5 57
68 2
77 72
31 7
4 13
47 46
39 20
82 68
14 29
83 10
12 46
16 52
28 59
82 64
75 21
43 74
86 4
26 4
47 86
52 46
7 54
54 11
23 22
24 34
65 3
78 57
27 68
28 23
3 41
3 52
63 24
18 8
47 60
65 8
43 28
43 51
2 53
19 56
55 18
86 77
33 22
79 21
86 19
31 61
24 51
75 23
21 48
51 43
61 56
47 41
62 34
22 62
7 74
14 83
19 3
47 13
35 24
14 22
19 60
73 44
69 45
51 9
74 72
54 4
59 47
46 82
8 46
11 36
7 17
56 9
10 36
13 88
56 81
1 54
87 83
61 67
76 36
80 65
62 83
69 86
26 51
87 2
5 59
31 18
83 37
1 79
58 0
74 40
51 40
26 70
18 41
71 2
23 80
38 86
5 42
62 38
42 28
83 66
46 9
70 8
35 55
75 33
50 0
20 41
39 69
9 62
55 72
84 89
49 56
74 15
0 79
16 78
70 66
6 28
*/